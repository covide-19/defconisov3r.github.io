<!-- ADD LOCATION: https://forms.gle/6wn1bmg8XZ8Bdrad8 -->
<!-- SHARABLE LINK: https://docs.google.com/spreadsheets/d/1zKvuJcQ4JGTSNwAnO7cDjTl0ACP99gEBLTeap9TRTkY/edit?usp=sharing-->
<!-- PUBLISHED LINK: https://docs.google.com/spreadsheets/d/e/2PACX-1vQAZK1_rqugl4k37fl40S_oZ9cGhwjdVJn3rJitHBDMmZ1kIZE1GcKiJ_aaKcnuF-OLQY8ZD_vfU8h7/pubhtml?gid=0&single=true -->
<!DOCTYPE html>
<html lang="en">
<head>
	<title>COVID-19 Screening</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
	<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700,900&display=swap" rel="stylesheet">
	<script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="styles.css">
</head>
<body>
	<!-- BACK TO TOP -->
	<button onclick="topFunction()" id="back-to-top" title="Go to top">Back to Top</button>
	
	<!-- MODAL SECTION -->
	<div class="modal fade" id="myModal">
		<div class="modal-dialog modal-lg modal-dialog-centered">
			<div class="modal-content">
			
			<!-- Modal Header -->
			<div class="modal-header">
				<h4 id="modal-title" class="modal-title">Find a Test Center</h4>
				<button type="button" class="close" data-dismiss="modal">&times;</button>
			</div>
			
			<!-- Modal body -->
			<div class="modal-body text-center">
				<h3 id="modal-text"></h3>
				<img class="img-fluid align-self-center" src="img/map.png" alt="Map Image">
			</div>
			
			<!-- Modal footer -->
			<div class="modal-footer">
				<button id="modal-btn" type="button" class="my-btn" onclick="eatSpreadsheet()">
					<div id="modal-spinner" class="hide-spinner spinner-border"></div>
					Find Center Near Me
				</button>
			</div>
			
			</div>
		</div>
	   </div>

	<!-- NAV SECTION -->
	<div class="hero-bg"></div>
	<nav class="container navbar navbar-expand-md navbar-light">
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse justify-content-center" id="collapsibleNavbar">
			<ul class="navbar-nav">
				<li class="nav-item my-nav-item">
					<a class="nav-link" href="https://github.com/ThouShawNotPass/PNW_COVID19_Triage">Open Source</a>
				</li>
				<li class="nav-item my-nav-item">
					<a class="nav-link" href="https://forms.gle/6wn1bmg8XZ8Bdrad8">Add Testing Center</a>
				</li>
				<li class="nav-item my-nav-item">
					<a class="nav-link" href="https://www.cdc.gov/coronavirus/2019-ncov/index.html">CDC Information</a>
				</li>   
			</ul>
		</div>  
	</nav>

	<!-- HERO SECTION -->
	<section class="container hero">
		<div class="row">
			<div class="col-sm-6 hero-left">
				<div class="container">
					<div class="row">
						<h1>Don't Panic.</h1>
					</div>
					<div class="row">
						<h1>We are here to help.</h1>
					</div>
					<br>
					<div class="row">
						<h4>
							Check your symptoms with cutting-edge A.I.
							or find COVID-19 testing centers in your area
							with our crowdsourced database.
						</h4>
					</div>
					<br>
					<div class="row d-flex justify-content-between">
						<button type="button" onclick="window.open('https://www.buoyhealth.com/symptom-checker/', '_blank')" class="my-btn">Check Symptoms</button>
						<button type="button" class="my-btn" data-toggle="modal" data-target="#myModal">&nbsp;Find Test Center&nbsp;</button>
					</div>
				</div>
			</div>
			<div class="col-sm-6 hero-right">
				<img class="img-fluid" src="img/hero-img.png" alt="Doctor in a lab">
			</div>
		</div>
	</section>

	<!-- KEEP YOURSELF SAFE -->
	<section class="container">
		<div class="row tip">
			<div class="col-sm-6 hero-left">
				<img class="img-fluid" src="img/wash-hands.png" alt="Wash your hands">
			</div>
			<div class="col-sm-6 hero-right">
				<div class="container">
					<h2>Clean your hands often</h2>
					<br>
					<ul class="my-ul">
						<li>
							<h3>
								Wash your hands often with soap and water for at least 20 seconds especially after you have been in a public place, or after blowing your nose, coughing, or sneezing.
							</h3>
						</li>
						<br>
						<li>
							<h3>
								If soap and water are not readily available, use a hand sanitizer that contains at least 60% alcohol. Cover all surfaces of your hands and rub them together until they feel dry.
							</h3>
						</li>
						<br>
						<li>
							<h3>
								Avoid touching your eyes, nose, and mouth with unwashed hands.
							</h3>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<hr>
		<div class="row tip">
			<div class="col-sm-6 hero-left">
				<div class="container">
					<h2>Avoid close contact</h2>
					<br>
					<ul class="my-ul">
						<li>
							<h3>
								Avoid close contact with people who are sick.
							</h3>
						</li>
						<br>
						<li>
							<h3>
								Put distance between yourself and other people if COVID-19 is spreading in your community. This is especially important for people who are at higher risk of getting very sick.
							</h3>
						</li>
					</ul>
				</div>
			</div>
			<div class="col-sm-6 hero-right">
				<img class="img-fluid" src="img/avoid-contact.png" alt="Wash your hands">
			</div>
		</div>
	</section>

	<!-- KEEP OTHERS SAFE -->
	<section class="container-fluid keep-others-safe">
		<div class="container">
			<div class="row tip">
				<div class="col-sm-6 hero-left">
					<img class="img-fluid" src="img/stay-home.png" alt="Stay home">
				</div>
				<div class="col-sm-6 hero-right">
					<div class="container">
						<h2>Stay home if you're sick</h2>
						<br>
						<ul class="my-ul">
							<li>
								<h3>
									Stay home if you are sick, except to get medical care. Learn what to do if you are sick.
								</h3>
							</li>
						</ul>
					</div>
				</div>
			</div>
			<hr>
			<div class="row tip">
				<div class="col-sm-6 hero-left">
					<div class="container">
						<h2>Cover your coughs and sneezes</h2>
						<br>
						<ul class="my-ul">
							<li>
								<h3>
									Cover your mouth and nose with a tissue when you cough or sneeze or use the inside of your elbow.
								</h3>
							</li>
							<br>
							<li>
								<h3>
									Throw used tissues in the trash.
								</h3>
							</li>
							<br>
							<li>
								<h3>
									Immediately wash your hands with soap and water for at least 20 seconds. If soap and water are not readily available, clean your hands with a hand sanitizer that contains at least 60% alcohol.
								</h3>
							</li>
						</ul>
					</div>
				</div>
				<div class="col-sm-6 hero-right">
					<img class="img-fluid" src="img/cover-sneeze.png" alt="Cover your sneezes">
				</div>
			</div>
			<hr>
			<div class="row tip">
				<div class="col-sm-6 hero-left">
					<img class="img-fluid" src="img/wear-mask.png" alt="Wear mask">
				</div>
				<div class="col-sm-6 hero-right">
					<div class="container">
						<h2>Wear a mask if you are sick</h2>
						<br>
						<ul class="my-ul">
							<li>
								<h3>
									<strong>If you are sick:</strong> You should wear a facemask when you are around other people (e.g., sharing a room or vehicle) and before you enter a healthcare providerâ€™s office. If you are not able to wear a facemask (for example, because it causes trouble breathing), then you should do your best to cover your coughs and sneezes, and people who are caring for you should wear a facemask if they enter your room. Learn what to do if you are sick.
								</h3>
							</li>
							<br>
							<li>
								<h3>
									<Strong>If you are NOT sick:</Strong> You do not need to wear a facemask unless you are caring for someone who is sick (and they are not able to wear a facemask). Facemasks may be in short supply and they should be saved for caregivers.
								</h3>
							</li>
						</ul>
					</div>
				</div>
			</div>
			<hr>
			<div class="row tip">
				<div class="col-sm-6 hero-left">
					<div class="container">
						<h2>Clean and disinfect</h2>
						<br>
						<ul class="my-ul">
							<li>
								<h3>
									Clean AND disinfect frequently touched surfaces daily. This includes tables, doorknobs, light switches, countertops, handles, desks, phones, keyboards, toilets, faucets, and sinks.
								</h3>
							</li>
							<br>
							<li>
								<h3>
									If surfaces are dirty, clean them: Use detergent or soap and water prior to disinfection.
								</h3>
							</li>
						</ul>
					</div>
				</div>
				<div class="col-sm-6 hero-right">
					<img class="img-fluid" src="img/clean-surfaces.png" alt="Clean and disinfect">
				</div>
			</div>
		</div>
	</section>

	<!-- FOOTER -->
	<div id="snackbar" class="show">
		<span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
		DISCLAIMER: The information contained herein should NOT be used as a substitute for the advice of 
		an appropriately qualified and licensed physician or other health care provider. If you think you 
		have been exposed to COVID-19 and develop a fever and symptoms, such as cough or difficulty breathing, 
		call your healthcare provider for medical advice.
	</div>
	<!-- <footer class="my-footer">
		Contact <a target="_blank" href="https://thoushawnotpass.github.io/portfolio/">Justin Shaw</a> for website questions.
	</footer> -->

	<script type='text/javascript'>    
		var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1zKvuJcQ4JGTSNwAnO7cDjTl0ACP99gEBLTeap9TRTkY/edit?usp=sharing';
		var backToTop = document.getElementById("back-to-top");
		var modalTitle = document.getElementById("modal-title");
		var modalText = document.getElementById("modal-text");
		var modalBtn = document.getElementById("modal-btn");
		var modalSpinner = document.getElementById("modal-spinner");
		var lat = 0;
		var lon = 0;
		clearText();

		// When the user scrolls down 20px from the top of the document, show the button
		window.onscroll = function() {scrollFunction()};

		function scrollFunction() {
			if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
				backToTop.style.display = "block";
			} else {
				backToTop.style.display = "none";
			}
		}
		
		// When the user clicks on the button, scroll to the top of the document
		function topFunction() {
			document.body.scrollTop = 0;
			document.documentElement.scrollTop = 0;
		}
		
		function eatSpreadsheet() {
			modalSpinner.classList.toggle("hide-spinner");
			getLocation();
		}
		
		function showInfo(data) {
			var minLat = data[0].latitude;
			var minLon = data[0].longitude;
			var min = distance(lat, lon, data[0].latitude, data[0].longitude);
			for (var i = 1; i < data.length; i++) {
				var newDist = distance(lat, lon, data[i].latitude, data[i].longitude);
				if (newDist < min) {
					min = newDist;
					minLat = data[i].latitude;
					minLon = data[i].longitude;
				}
			}
			var currentPos = lat + "," + lon;
			var testCenter = minLat + "," + minLon;
			var googleMapsUrl = "https://www.google.com/maps/dir/" + currentPos + "/" + testCenter + "/@" + currentPos + ",14z"
			console.log(data);
			modalSpinner.classList.toggle("hide-spinner");
			modalTitle.innerText = "Testing Center Found (" + min + "mi away)";
			modalBtn.innerText = "Take me there";
			modalBtn.onclick = function(){ window.open(googleMapsUrl, '_blank'); } ;
		}

		// calculates dist between two pts in miles
		function distance(lat1, lon1, lat2, lon2) {
			var p = 0.017453292519943295; // Math.PI / 180
			var c = Math.cos;
			var a = 0.5 - c((lat2 - lat1) * p)/2 + c(lat1 * p) * c(lat2 * p) * (1 - c((lon2 - lon1) * p))/2;
			var result = 0.621371 * 12742 * Math.asin(Math.sqrt(a)); // 2 * R; R = 6371 km => miles
			return Math.round(result * 10) / 10;
		}

		function getLocation() {
			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(showPosition, showError);
			} else {
				alert('Geolocation is not supported by this browser.')
			}
			console.log('Processing location...');
		}

		function showPosition(position) {
			lat = position.coords.latitude;
			lon = position.coords.longitude;
			console.log('Current Location: (' + lat + ', ' + lon + ')');
			Tabletop.init({ 
				key: publicSpreadsheetUrl, 
				callback: showInfo, 
				simpleSheet: true})
		}

		function showError(error) {
			switch(error.code) {
				case error.PERMISSION_DENIED:
					alert("We need your location to find you the closest testing center. Please reload the page and try again.");
					break;
				case error.POSITION_UNAVAILABLE:
					alert("Hmmm... Location information is unavailable. Please try again later.");
					break;
				case error.TIMEOUT:
					alert("Well. The request to get your location timed out. Please try again later.");
					break;
				case error.UNKNOWN_ERROR:
					alert("Oof. An unknown error occurred. Please try again later.");
					break;
			}
		}

		function clearText() {
			modalText.innerHTML = "";
		}
		
	</script>
</body>
</html>